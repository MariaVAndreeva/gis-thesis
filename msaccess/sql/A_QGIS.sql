SELECT Mid(T_Befund_GeogrLage.GeogrKoordinaten_nach_Opitz_2014,11,8) AS LONGITUDE, Mid(T_Befund_GeogrLage.GeogrKoordinaten_nach_Opitz_2014,1,8) AS LATITUDE, T_Befund_GeogrLage.*, T_Befund.ID_Befund, T_Befund.ID_Parent_Befund, T_Befund.Befund_Lage_Gelaende_Standartisiert, T_Befund.Befund_Lage_Gelaende, T_Befund.Befund_Quelle, T_Befund.Befund_Form, T_Befund.Befund_Kennzeichnung, T_Befund.Befund_Graeberfeld_Flaeche, T_Befund.Befund_Graeberfeld_Anz_bek_Einheiten, T_Befund.Bezeichnung_bek_Einheiten, T_Befund.Befund_Huegel_Grab_Bestattung_bes_Stellung, T_Befund.Befund_Form_Huegel_Form, T_Befund.Befund_Form_Huegel_Hoehe, T_Befund.Befund_Form_Huegel_Durchmesser, T_Befund.Befund_Form_Huegel_Breite, T_Befund.Befund_Form_Huegel_Laenge, T_Befund.Befund_Form_Huegel_Zus_Info, T_Befund.Befund_Form_Innere_Ausstattung_Art, T_Befund.Befund_Form_Innere_Ausstattung_Hoehe, T_Befund.Befund_Form_Innere_Ausstattung_Breite, T_Befund.Befund_Form_Innere_Ausstattung_Laenge, T_Befund.Befund_Form_Innere_Ausstattung_Durchmesser, T_Befund.Befund_Form_Innere_Ausstattung_Zus_Info, T_Befund.Befund_Zustand, T_Befund.Befund_Begraebnis_Abfolge, T_Befund.Befund_Begraebnis_Ritus, T_Befund.Orientierung, T_Befund.Alter_Bestimmungsart, T_Befund.Altersbestimmung, T_Befund.Geschlecht_Bestimmungsart, T_Befund.Geschlechtsbestimmung, T_Befund.Konstruktionsbesonderheiten, T_Befund.Konstruktionsbesonderheiten_Zus_fassung, T_Befund.Funde, T_Befund.Funde_Anzahl, T_Befund.Funde_Zus_fassung, T_Befund.Befund_Funde_Zuordenbarkeit, T_Befund.Befund_Funde_Vorhandensein, T_Befund.Literaturangaben AS T_Befund_Literaturangaben, T_Befund.Zus_Information, T_Befund.Datierung_Beginn, T_Befund.Datierung_Belegung, T_Befund.Datierung_Ende, T_Befund.Datierung_Schwerpunkt, Fund.ID_Fund, Fund.ID_Fund_Publ, Fund.ID_Grabung, Fund.Fund_Ueberueberklasse, Fund.Fund_Ueberklasse, Fund.Fund_Klasse, Fund.Fund_Zuordnung, Fund.Fund_Zuordnung_Kommentar, Fund.Fund_Klasse_Beschreibung_Katalog, Fund.Anzahl, Fund.Abbildung, (SELECT COUNT(*) FROM T_Fund_Abbildung WHERE T_Fund_Abbildung.ID_Fund = Fund.ID_Fund) AS Anzahl_Fund_Abbildungen, Fund.Beschreibung_Katalog, Fund.Masse_Katalog, Fund.Fund_Lage_im_Befund_Kommentar, Fund.Fund_Lage_im_Befund, Fund.Zus_Info, Fund.Beschreibung_Quellen_Kommentare, Fund.Fund_Material_Abkuerzung, Fund.Fund_Zustand, Fund.Fund_Verbleib, Fund.Inv_Nr, Fund.Datierung, Fund.Datierung_Kommentar, Fund.Literaturangaben AS T_Fund_Literaturangaben, Fund.Fund_verketten, Fund.Fund_Verbleib_verketten, T_Fund_Typ.ID_Fund_Typ_auto, T_Fund_Typ.ID_Fund_Typ, T_Fund_Typ.Fund_Typ, T_Fund_Typ.Fund_Klasse_Beschreibung, T_Fund_Typ.Beschreibung, (SELECT COUNT(*) FROM T_Befund WHERE ID_GeogrLage = T_Befund_GeogrLage.ID_GeogrLage) AS Anzahl_Befunde, (SELECT COUNT(*) FROM T_Fund INNER JOIN T_Befund ON T_Befund.ID_Befund = T_Fund.ID_Befund WHERE T_Befund.ID_GeogrLage = T_Befund_GeogrLage.ID_GeogrLage) AS Anzahl_Funde, (SELECT COUNT(*) FROM T_Fund WHERE ID_Befund = Fund.ID_Befund AND (Fund_Klasse LIKE '%Lanzen%' OR Fund_Klasse LIKE '*Lanzen*')) AS Anzahl_Lanzen_Im_Befund, T_Fund_Abbildung.ID_Fund_Abbildung AS Erste_Fund_Abbildung_ID, T_Fund_Abbildung.Fund_Abbildung.FileName AS Erste_Fund_Abbildung_File_Name, T_Fund_Abbildung.Fund_Abbildung.FileType AS Erste_Fund_Abbildung_File_Type, IIf(IsNull(T_Fund_Abbildung.ID_Fund_Abbildung),"",Replace("file:///" & (SELECT VALUE FROM QGIS_CONFIG WHERE KEY = 'ATTACHMENTS_DIR') & "/" & T_Fund_Abbildung.ID_Fund_Abbildung & '-' & T_Fund_Abbildung.Fund_Abbildung.FileName,"\","/")) AS Erste_Fund_Abbildung_URL
FROM (T_Fund_Typ INNER JOIN ((T_Befund_GeogrLage INNER JOIN T_Befund ON T_Befund_GeogrLage.ID_GeogrLage = T_Befund.ID_GeogrLage) INNER JOIN T_Fund AS Fund ON T_Befund.ID_Befund = Fund.ID_Befund) ON T_Fund_Typ.ID_Fund_Typ_auto = Fund.Fund_Typ) LEFT JOIN T_Fund_Abbildung ON Fund.ID_Fund = T_Fund_Abbildung.ID_Fund
WHERE (((T_Fund_Abbildung.ID_Fund_Abbildung) Is Null Or (T_Fund_Abbildung.ID_Fund_Abbildung)=(SELECT MIN(T_Fund_Abbildung.ID_Fund_Abbildung) FROM T_Fund_Abbildung WHERE Fund.ID_Fund = T_Fund_Abbildung.ID_Fund)))
ORDER BY T_Befund_GeogrLage.ID_GeogrLage, T_Befund.ID_Befund, Fund.ID_Fund;